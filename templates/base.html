{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Home{% endblock title %}</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Nunito:ital,wght@0,200..1000;1,200..1000&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <link rel="stylesheet" href="{% static 'fontawesome/css/all.css' %}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css">
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    {% csrf_token %}
</head>
<body>
    <main>
        {% block content %}
        {% endblock %}
    </main>

    <!-- <div class="modal hidden" id="locationModal">
        <div class="modal-body absolute bottom-0 w-full lg:w-96 lg:left-[50%] lg:top-14 lg:bottom-auto lg:-translate-x-[50%]">
            <button role="button" id="closeBtn" class="close-btn block mx-auto size-10 rounded-full bg-black bg-opacity-35 text-white"><i class="fa-regular fa-xmark"></i></button>
            <div class="modal-content p-5 w-full bg-gray-200 mt-3 rounded-tl-xl rounded-tr-xl min-h-64 lg:rounded-lg">
                <div class="relative">
                    <input type="text" id="locsearch" placeholder="Search your area" class="w-full border-none bg-white rounded-lg p-3 outline-none">
                </div>
                <button role="button" id="getLocationBtn" class="text-primary mt-3 font-semibold cursor-pointer bg-white p-3 w-full rounded-lg flex justify-start items-center gap-2 relative">
                    <i class="fa-solid fa-location-crosshairs text-lg"></i>
                    Use my current location
                    <i class="fa-solid fa-angle-right text-lg absolute right-3 top-[14px] text-gray-500"></i>
                </button>
                <p id="output" class="mt-3"></p>
            </div>
        </div>
    </div> -->

    <div class="modal hidden" id="searchModal">
        <div class="modal-body absolute bottom-0 w-full lg:w-96 lg:left-[50%] lg:top-14 lg:bottom-auto lg:-translate-x-[50%]">
            <button role="button" id="closeBtn" class="close-btn block mx-auto size-10 rounded-full bg-black bg-opacity-35 text-white"><i class="fa-regular fa-xmark"></i></button>
            <div class="modal-content p-3 w-full bg-gray-200 mt-3 rounded-tl-xl rounded-tr-xl min-h-64 lg:rounded-lg">
                <h2 class="text-lg font-semibold text-black">Search</h2>
                <input type="search" id="search_input" placeholder="Search..." class="w-full px-3 py-2 text-black border border-gray-300 rounded-lg mt-3 outline-none font-medium bg-white focus:border-blue-300">

                <div id="searchResult" class="rounded-lg mt-3 overflow-hidden">
                    
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <script src="{% static 'js/main.js' %}"></script>
    <script>
        $(document).ready(function () {
            let timer;
            $("#search_input").keyup(function () {
                clearTimeout(timer);
                let text = $(this).val().trim();

                if (text.length < 1){
                    $('#searchResult').empty();
                    return;
                };

                timer = setTimeout(function () {
                    $.ajax({
                        url: "/search/",
                        type: "GET",
                        data: { q: text },
                        success: function (res) {
                            $('#searchResult').empty();
                            
                            if (res.results.length === 0) {
                                
                                $('#searchResult').append("<p>No results found</p>");
                            }

                            res.results.forEach(function (item) {
                                $("#searchResult").append(
                                    `<p data-id="${item.slug}" class="text-gray-600 font-semibold cat-item"><a href="/category/${item.slug}">${item.name}</a></p>`
                                );
                            });
                        }
                    });
                }, 400);  // waits 400ms after user stops typing
            });
        });
    </script>
    {% block extra_js %}
    
    {% endblock extra_js %}
</body>
</html>